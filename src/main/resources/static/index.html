<head>
    <style>
        :root {
            background: #87CEFA;
        }

        .chat {
            background: #EEE8AA;
            font-family: "Courier New", Courier, monospace;
            position: absolute;
            padding: 10px;
            width: 1076px;
            left: 235px;
            top: 55px;
            overflow: auto;
            margin: 0 0 0 0;
            white-space: pre-wrap;
        }

        .form {
            position: absolute;
            height: 85%;
        }

        .msginput {
            width: 82%;
        }

        .sendbutton {
            width: 15%;
        }

        #header {
            background: #87CEFA;
            padding: 10px;
            padding-bottom: 0;
        }

        #body {
            padding: 10px;
            padding-top: 0;
            padding-bottom: 30px; /* Height of the footer */
        }

        #left {
            position: absolute;
            padding: 10px;
            left: 18px;
            width: 200px;
            top: 55px;
            height: 85%;
            background: #F4A460;
            font-family: "Times New Roman", Times New Roman, monospace;
            overflow: auto;
            margin: 0 0 0 0;
        }

        #footer {
            padding: 10px;
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 23px; /* Height of the footer */
            background: #87CEFA;
        }
        #nameform3 {
            position: absolute;
            top: 16px;
            right: 19px;
        }
        #nameform2 {
            position : absolute;
            top: 16px;
            left : 240px;
        }

        #name1 {
            width: 214px;
        }
        .usersform {
            background: #87C89A;
        }

    </style>
</head>
<html>
<body>
<div id="header">
    <form method="POST" id="nameform3" action="javascript:void(null);" onsubmit="logout()">
        <input value="Logout" style="font-size:large" type="submit">
    </form>
</div>
<div id = "left">
    <div id="usersonline" class="usersform"></div>
</div>
<div id="body">
    <div id="history" class="chat form"></div>
</div>
<div id="footer">
    <form method="POST" id="msgform" action="javascript:void(null);" onsubmit="say()">
        <input id="msg" name="msg" class="msginput" value="" style="font-size:medium" type="text">
        <input value="Send" class="sendbutton" style="font-size:large" type="submit">
    </form>
</div>
</body>
</html>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script>
    var host = "localhost";
    var port = 8080;
    var domain = "/chat";

    function loadHistory() {
        var settings = {
            "crossDomain": true,
            "url": "http://" + host + ":" + port + domain + "/chat",
            "method": "GET",
        }

        $.ajax(settings).done(function (response) {
            $("#history").html(response.replace(/\n/g, "<br />"))
            $("#history").scrollTop($("#history")[0].scrollHeight);
        }).fail(function (jqXHR, textStatus) {
            console.log(jqXHR.status + " " + jqXHR.statusText + ". " + jqXHR.responseText);
        });
    }

    function loadUsers() {
        var settings = {
            "crossDomain": true,
            "url": "http://" + host + ":" + port + domain + "/online",
            "method": "GET",
        }

        $.ajax(settings).done(function (response) {
            $("#usersonline").html(response.replace(/\n/g, "<br />"))
        }).fail(function (jqXHR, textStatus) {
            console.log(jqXHR.status + " " + jqXHR.statusText + ". " + jqXHR.responseText);
        });
    }

    function say() {

        var msg = $('#msgform').serialize();

        var settings = {
            "method": "POST",
            "crossDomain": true,
            "url": "http://" + host + ":" + port + domain + "/say",
            "data": msg
        };

        $.ajax(settings).done(function (response) {
            $('#msgform').trigger("reset");
            loadHistory();
        }).fail(function (jqXHR, textStatus) {
            alert(jqXHR.status + " " + jqXHR.statusText + ". " + jqXHR.responseText);
            console.log(jqXHR.status + " " + jqXHR.statusText + ". " + jqXHR.responseText);
        });
    }

    function logout() {
        var settings = {
            "method": "POST",
            "crossDomain": true,
            "url": "http://" + host + ":" + port + domain + "/logout"
        };

        $.ajax(settings).done(function (response) {
            loadHistory();
            loadUsers();
        }).fail(function (jqXHR, textStatus) {
            alert(jqXHR.status + " " + jqXHR.statusText + ". " + jqXHR.responseText);
            console.log(jqXHR.status + " " + jqXHR.statusText + ". " + jqXHR.responseText);
        });
    }

    loadHistory();
    setInterval(loadHistory, 10000);
    loadUsers();
    setInterval(loadUsers, 10000);
</script>